/*!
 * smart-text-ellipsis v0.0.3
 * Copyright 2025 wuzhanggui https://github.com/wurencaideli
 * Licensed under MIT
 */
"use strict";function t(t,e,s,i){if("a"===s&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?i:"a"===s?i.call(t):i?i.value:e.get(t)}function e(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function s(t,e){t.classList.add(e)}function i(t,e){t.classList.remove(e)}var a,l,o,n,r,h,p,c,d,m;"function"==typeof SuppressedError&&SuppressedError;l=new WeakMap,a=new WeakSet,o=function(){this.isDestroyed||(this.isOpen=!0,this.update(),this.afterExpand&&this.afterExpand())},n=function(){this.isDestroyed||(this.isOpen=!1,this.update(),this.afterCollapse&&this.afterCollapse())},r=function(){const t=this.targetEl;t&&(this.isDestroyed?t.style.setProperty("--max-lines",null):t.style.setProperty("--max-lines",`${this.maxLines}`),1==this.maxLines?(s(t,"smart-text-ellipsis-one"),i(t,"smart-text-ellipsis-more")):(s(t,"smart-text-ellipsis-more"),i(t,"smart-text-ellipsis-one")),this.isOpen&&(i(t,"smart-text-ellipsis-more"),i(t,"smart-text-ellipsis-one")),i(t,"is-ellipsis"),i(t,"is-exceeded-max-line"))},h=function(){if(this.isDestroyed)return;const e=this.targetEl;this.isOpen?t(this,a,"m",m).call(this)>this.maxLines&&s(e,"is-exceeded-max-line"):t(this,a,"m",d).call(this)&&s(e,"is-ellipsis")},p=function(){const e=t(this,l,"f"),s=this.placeholderEl,i=this.targetEl;s.style.height=i.clientHeight-e+"px"},c=function(){const t=this.targetEl;return parseFloat(getComputedStyle(t).lineHeight)||24},d=function(){const t=this.maxLines,e=this.targetEl;return 1===t?e.scrollWidth>e.clientWidth:e.scrollHeight>e.clientHeight},m=function(){const e=this.targetEl,s=this.collapseEl,i=t(this,l,"f");return Math.floor((e.clientHeight-s.clientHeight)/i)},exports.SmartTextEllipsis=class{constructor(e){a.add(this),this.isDestroyed=!1,this.maxLines=0,this.isOpen=!1,this.afterExpand=void 0,this.afterCollapse=void 0,this.stopClickPropagation=!1,l.set(this,0);const i=e.targetEl,r=e.isOpen,h=e.maxLines,p=e.stopClickPropagation,c=e.afterExpand,d=e.afterCollapse,m=document.createElement("span"),f=document.createElement("div"),x=document.createElement("div");m.innerText=e.expandElText||"Expand",f.innerText=e.collapseElText||"Collapse",s(f,"smart-text-ellipsis-collapse"),s(m,"smart-text-ellipsis-expand"),s(x,"smart-text-ellipsis-placeholder"),i.prepend(m),i.prepend(x),i.appendChild(f),this.targetEl=i,this.isOpen=r,this.maxLines=h,this.expandEl=m,this.collapseEl=f,this.placeholderEl=x,this.stopClickPropagation=p,this.afterExpand=c,this.afterCollapse=d,m.onclick=e=>{this.stopClickPropagation&&e.stopPropagation(),t(this,a,"m",o).call(this)},f.onclick=e=>{this.stopClickPropagation&&e.stopPropagation(),t(this,a,"m",n).call(this)},this.update()}destroy(){this.isOpen=!0,e(this.expandEl),e(this.collapseEl),t(this,a,"m",r).call(this),this.targetEl=void 0,this.expandEl=void 0,this.collapseEl=void 0,this.isDestroyed=!0}update(){this.isDestroyed||(!function(t,e,s,i,a){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!a:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");"a"===i?a.call(t,s):a?a.value=s:e.set(t,s)}(this,l,t(this,a,"m",c).call(this),"f"),t(this,a,"m",r).call(this),t(this,a,"m",p).call(this),t(this,a,"m",h).call(this))}expand(){t(this,a,"m",o).call(this)}collapse(){t(this,a,"m",n).call(this)}};
//# sourceMappingURL=smart-text-ellipsis.cjs.js.map
