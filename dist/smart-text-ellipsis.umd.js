/*!
 * smart-text-ellipsis v0.0.3
 * Copyright 2025 wuzhanggui https://github.com/wurencaideli
 * Licensed under MIT
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self)["smart-text-ellipsis"]={})}(this,function(t){"use strict";function e(t,e,i,s){if("a"===i&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?s:"a"===i?s.call(t):s?s.value:e.get(t)}function i(t){t&&t.parentNode&&t.parentNode.removeChild(t)}function s(t,e){t.classList.add(e)}function l(t,e){t.classList.remove(e)}var a,o,n,r,h,p,c,d,f,m;"function"==typeof SuppressedError&&SuppressedError;o=new WeakMap,a=new WeakSet,n=function(){this.isDestroyed||(this.isOpen=!0,this.update(),this.afterExpand&&this.afterExpand())},r=function(){this.isDestroyed||(this.isOpen=!1,this.update(),this.afterCollapse&&this.afterCollapse())},h=function(){const t=this.targetEl;t&&(this.isDestroyed?t.style.setProperty("--max-lines",null):t.style.setProperty("--max-lines",`${this.maxLines}`),1==this.maxLines?(s(t,"smart-text-ellipsis-one"),l(t,"smart-text-ellipsis-more")):(s(t,"smart-text-ellipsis-more"),l(t,"smart-text-ellipsis-one")),this.isOpen&&(l(t,"smart-text-ellipsis-more"),l(t,"smart-text-ellipsis-one")),l(t,"is-ellipsis"),l(t,"is-exceeded-max-line"))},p=function(){if(this.isDestroyed)return;const t=this.targetEl;this.isOpen?e(this,a,"m",m).call(this)>this.maxLines&&s(t,"is-exceeded-max-line"):e(this,a,"m",f).call(this)&&s(t,"is-ellipsis")},c=function(){const t=e(this,o,"f"),i=this.placeholderEl,s=this.targetEl;i.style.height=s.clientHeight-t+"px"},d=function(){const t=this.targetEl;return parseFloat(getComputedStyle(t).lineHeight)||24},f=function(){const t=this.maxLines,e=this.targetEl;return 1===t?e.scrollWidth>e.clientWidth:e.scrollHeight>e.clientHeight},m=function(){const t=this.targetEl,i=this.collapseEl,s=e(this,o,"f");return Math.floor((t.clientHeight-i.clientHeight)/s)},t.SmartTextEllipsis=class{constructor(t){a.add(this),this.isDestroyed=!1,this.maxLines=0,this.isOpen=!1,this.afterExpand=void 0,this.afterCollapse=void 0,this.stopClickPropagation=!1,o.set(this,0);const i=t.targetEl,l=t.isOpen,h=t.maxLines,p=t.stopClickPropagation,c=t.afterExpand,d=t.afterCollapse,f=document.createElement("span"),m=document.createElement("div"),u=document.createElement("div");f.innerText=t.expandElText||"Expand",m.innerText=t.collapseElText||"Collapse",s(m,"smart-text-ellipsis-collapse"),s(f,"smart-text-ellipsis-expand"),s(u,"smart-text-ellipsis-placeholder"),i.prepend(f),i.prepend(u),i.appendChild(m),this.targetEl=i,this.isOpen=l,this.maxLines=h,this.expandEl=f,this.collapseEl=m,this.placeholderEl=u,this.stopClickPropagation=p,this.afterExpand=c,this.afterCollapse=d,f.onclick=t=>{this.stopClickPropagation&&t.stopPropagation(),e(this,a,"m",n).call(this)},m.onclick=t=>{this.stopClickPropagation&&t.stopPropagation(),e(this,a,"m",r).call(this)},this.update()}destroy(){this.isOpen=!0,i(this.expandEl),i(this.collapseEl),e(this,a,"m",h).call(this),this.targetEl=void 0,this.expandEl=void 0,this.collapseEl=void 0,this.isDestroyed=!0}update(){this.isDestroyed||(!function(t,e,i,s,l){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!l)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!l:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");"a"===s?l.call(t,i):l?l.value=i:e.set(t,i)}(this,o,e(this,a,"m",d).call(this),"f"),e(this,a,"m",h).call(this),e(this,a,"m",c).call(this),e(this,a,"m",p).call(this))}expand(){e(this,a,"m",n).call(this)}collapse(){e(this,a,"m",r).call(this)}}});
//# sourceMappingURL=smart-text-ellipsis.umd.js.map
